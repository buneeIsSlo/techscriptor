<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZS5V7Y5JT4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-ZS5V7Y5JT4');
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Techscriptor</title>
    <style type="text/css" media="screen">
    html, body {
      height: 100%;
    }
    #editor {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
    }
    #mdview {
        padding: 20px;
    }
    blockquote {
      background: #f9f9f9;
      border-left: 3px solid #ccc;
      margin: 1.5em 10px;
      padding: 0.5em 10px;
    }
    blockquote p {
      display: inline-block;
    }
    </style>
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
</head>
<body>
<div class="container-fluid h-100">
  <div class="row h-100">
      <div class="col h-100" style="position: relative;">
<div id="editor"># Built for Technical Writing

_Techscriptor_ is a free online Markdown editor that makes your writing clear.

---

## Highlighting Common Errors
The app helps you avoid the following common errors:

* **Long sentences:** Make your sentences short and clear. If you see a yellow
highlight, your sentence is so dense and complicated that your readers will get
lost trying to understand it and then you should consider splitting it up.
* **Passive voice:** Use the active voice most of the time. If the passive voice
is used, sentences tend to be more wordy and vague.
* **Generic words:** Reduce imprecise, weak, or generic words. There are
sentences where it can happen that the reader finds them difficult to read.
* **Adverbs:** Avoid adverbs if they add no significant meaning. Unfortunately,
adverbs sometimes make technical readers bark loudly and ferociously.

</div>
      </div>
      <div class="col overflow-scroll h-100" id="mdview"></div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.10.1/ace.min.js" integrity="sha512-LsPG7HaqMY141NrHpwkr7NyZ1Ede5kqiyyxynjCIh0y593ucZeNNZ1ViO++TJAVusvsh6ZGkE8Vd/5WEp5TGvw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.10.1/theme-chrome.min.js" integrity="sha512-IoW2AJDFMQYyoy2/RXHXuejhOyYdER5cWEa5daKogz7AS2xou/WCCpghsgBDZG3/V4VCDuJw2RvVhUW81bhlDQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.10.1/mode-markdown.min.js" integrity="sha512-iYsFt92n+888KkIWz9rMd1EVL/sI/dzH26ESth7p1N2JoRCMSE7Zgiuev34j1Knd7vyizT4RCu1e456c2YxLwg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.1/markdown-it.min.js" integrity="sha512-SYfDUYPg5xspsG6OOpXU366G8SZsdHOhqk/icdrYJ2E/WKZxPxze7d2HD3AyXpT7U22PZ5y74xRpqZ6A2bJ+kQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
<script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/chrome");
    editor.session.setMode("ace/mode/markdown");
    editor.setOptions({
        fontSize: 14,
        vScrollBarAlwaysVisible: true,
        wrap: true
    });
    function loadPopovers() {
        var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
        // console.log(popoverTriggerList);
        var popoverList = popoverTriggerList.map(function(element){
            return new bootstrap.Popover(element, {
              trigger: 'hover focus',
              html: true
            });
        });
    }
    function getPopover(text, message, color) {
        return "<span style=\"background: " + color +
            ";\" tabindex=\"0\" data-bs-toggle=\"popover\" "+
            "data-bs-trigger=\"focus\" data-bs-placement=\"top\" "+
            "data-bs-content=\"" + message + "\">" + text + "</span>";
    }
    var md = window.markdownit();
    const beforeUnloadListener = (event) => {
      event.preventDefault();
      return event.returnValue = "Are you sure you want to exit?";
    };
    function getReplacementString(i) {
        return "[#r"+ i + "]";
    }
    function updateView() {
        htmlOutput = md.render(editor.getValue());
        const replacements = [];
        const rules = {
            "hardToRead": {
                "regex": /((\w+,\s+)|(\w+\s+)){20,}(\w+[\.|?|!])/g,
                "message": "This sentence is hard to read.",
                "color": "#f0f0a0"
            },
            "thereIsThereAre": {
                "regex": /\bThere (is|are)\b/g,
                "message": "<em>Generic:</em> Be precise.",
                "color": "#f0a0f0"
            },
            "adverbs": {
                "regex": /(\w+)ly/g,
                "message": "<em>Adverb:</em> Use a forceful verb.",
                "color": "#a0e0ff"
            },
            "passiveVoice": { // \b((be(en)?)|(w(as|ere))|(is)|(a(er|m)))(\s\w+(en|ed))(\W)
                "regex": /\b((be(en)?)|(w(as|ere))|(is)|(a(er|m)))(.+(en|ed))([\s]|\.|\,)/g,
                "message": "<em>Passive voice:</em> Use active voice.",
                "color": "#a0f0a0"
            },
            "genericVerb": {
                "regex": /\b(happen|occur)(s?)/g,
                "message": "<em>Generic verb:</em> Use precise verbs.",
                "color": "#f0a0f0"
            }
        }
        for(var label in rules) {
            rule = rules[label];
            htmlOutput = htmlOutput.replaceAll(rule["regex"], function(match) {
                replacements.push(getPopover(match, rule["message"], rule["color"]));
                return getReplacementString(replacements.length - 1);
            });
        }
        for (let i = 0; i < replacements.length; i++) {
            htmlOutput = htmlOutput.replace(getReplacementString(i), replacements[i]);
        }
        htmlOutput = htmlOutput.replaceAll("<blockquote>", "<blockquote class=\"blockquote\">");
        document.getElementById('mdview').innerHTML = htmlOutput;
        loadPopovers();
        addEventListener("beforeunload", beforeUnloadListener, {capture: true});
    }
    updateView();
    editor.session.on('change', function(delta) {updateView();});
</script>
</body>
</html>

